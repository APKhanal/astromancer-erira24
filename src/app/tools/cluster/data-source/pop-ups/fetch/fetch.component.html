<div class="cluster-data-source-pop-up">
  <mat-card class="cluster-data-source-pop-ups-card">
    <mat-card-header>
      <mat-card-subtitle *ngIf="data.name">{{data.name}}</mat-card-subtitle>
      <mat-card-title>Catalogue Fetching Preview</mat-card-title>
    </mat-card-header>

    <mat-card-content *ngIf="fetchData.length === 0">
      <form [formGroup]="formGroup">
        <div *ngIf="!data.name" class="row">
          <div class="col-12">
            <mat-form-field>
              <mat-label>Cluster Name</mat-label>
              <input [formControlName]="'name'" matInput>
            </mat-form-field>
          </div>
        </div>
        <div class="row">
          <div class="col-6">
            <mat-form-field>
              <mat-label>Right Ascension</mat-label>
              <input [formControlName]="'ra'" matInput>
            </mat-form-field>
          </div>
          <div class="col-6">
            <mat-form-field>
              <mat-label>Declination</mat-label>
              <input [formControlName]="'dec'" matInput>
            </mat-form-field>
          </div>
        </div>
        <div class="row">
          <div class="col-6">
            <mat-form-field>
              <mat-label>Radius</mat-label>
              <input [formControlName]="'radius'" matInput>
            </mat-form-field>
          </div>
          <div class="col-6">
            <mat-form-field>
              <mat-label>Catalogues</mat-label>
              <mat-select [formControlName]="'catalog'">
                <mat-option *ngFor="let catalog of catalogs" [value]="catalog">
                  {{catalog}}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
        </div>
      </form>
    </mat-card-content>

    <mat-card-content *ngIf="fetchData.length > 0">
      <div class="row">
        <div class="col-6">
          <p>
            <strong>Cluster</strong>: {{formGroup.controls['name'].value}}
            <br>
            <strong>Radius</strong>: {{formGroup.controls['radius'].value}}
          </p>
        </div>
        <div class="col-6">
          <p>
            <strong>Number of Stars</strong>: {{fetchData.length}}
            <br>
            <strong>Filters</strong>: {{filters.join(', ')}}
          </p>
        </div>
      </div>
    </mat-card-content>

    <mat-divider></mat-divider>

    <mat-card-actions>
      <button (click)="cancel()" mat-button mat-dialog-close>Cancel</button>
      <button (click)="testRadius()"
              [disabled]="loading"
              [hidden]="fetchData.length > 0"
              mat-button>Test Radius
      </button>
      <button (click)="fetchCatalog()"
              [disabled]="!readyForNext||loading"
              mat-button>Next
      </button>
    </mat-card-actions>

    <mat-progress-bar [hidden]="!loading" mode="query"></mat-progress-bar>
  </mat-card>
</div>
